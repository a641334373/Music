(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{30:function(t,e,i){t.exports=i(78)},35:function(t,e,i){},37:function(t,e,i){},39:function(t,e,i){},46:function(t,e,i){},67:function(t,e,i){},69:function(t,e,i){},71:function(t,e,i){},73:function(t,e,i){},75:function(t,e,i){},78:function(t,e,i){"use strict";i.r(e);var n=i(0),a=i.n(n),s=i(27),c=i.n(s),o=(i(35),i(4)),r=i(5),u=i(7),l=i(6),d=i(8),h=i(81),p=i(83),y=i(82),f=i(80),m=(i(37),i(39),i(12)),v=function(t){function e(){return Object(o.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(d.a)(e,t),Object(r.a)(e,[{key:"render",value:function(){return a.a.createElement("div",{id:"musicHeader"},this.props.isiconBack&&a.a.createElement("span",{onTouchStart:this.handleGoHistory},"<"),this.props.isMusicName?"\u6b63\u5728\u64ad\u653e:"+this.props.isMusicName:"\u83dc\u72d7\u97f3\u4e50")}},{key:"handleGoHistory",value:function(){window.history.go(-1)}}]),e}(n.Component);var g=Object(m.b)(function(t){return{MusicId:t.isMusicId,ClassActive:t.isClassActive,isiconBack:t.islistIcon,isMusicName:t.isMusicName}},function(t){return{iconBack:function(){t({type:"IS_ICON_BACK",payload:!1})},changeMusicName:function(e){t({type:"IS_CHANGE_NAME",payload:e})},setPathName:function(){t({type:"IS_CHANGE_PATHNAME",payload:"list"})}}})(v),b=i(2),I=(i(46),i(15)),M=i.n(I),E=(i(67),function(t){function e(){return Object(o.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(d.a)(e,t),Object(r.a)(e,[{key:"render",value:function(){return a.a.createElement("div",{className:"loading"},"Loading\u2026")}}]),e}(n.Component));function N(t){return window.sessionStorage.getItem(t)}var C=function(t){function e(){var t;return Object(o.a)(this,e),(t=Object(u.a)(this,Object(l.a)(e).call(this))).state={SongsList:[],isActive:2,isLoading:!1},t.isMove=!1,t.handleTouchEnd=t.handleTouchEnd.bind(Object(b.a)(Object(b.a)(t))),t.handleTouchMove=t.handleTouchMove.bind(Object(b.a)(Object(b.a)(t))),t}return Object(d.a)(e,t),Object(r.a)(e,[{key:"render",value:function(){var t=this;return a.a.createElement("div",{id:"musicList"},this.state.isLoading?a.a.createElement("ul",null,this.state.SongsList.map(function(e,i){return a.a.createElement("li",{className:t.props.MusicId===e.id?"active":"",key:e.id,onTouchMove:t.handleTouchMove,onTouchEnd:function(){return t.handleTouchEnd(e.id,e.title)}},a.a.createElement("div",{className:"listOrder"},i+1),a.a.createElement("div",{className:"listName"},a.a.createElement("h3",null,e.title),a.a.createElement("p",null,e.author)))})):a.a.createElement(E,null))}},{key:"componentDidMount",value:function(){var t=this;this.props.setLyricRunning(),this.props.iconBack();var e=N("songsList");e?this.setState({SongsList:JSON.parse(e),isLoading:!0}):M.a.post("/api/index/index",{TransCode:"020111",OpenId:"Test",Body:{SongListId:"141998290"}}).then(function(e){var i,n;"OK"===e.data.ErrCode&&t.setState({SongsList:e.data.Body.songs,isLoading:!0}),i="songsList",n=JSON.stringify(e.data.Body.songs),window.sessionStorage.setItem(i,n)})}},{key:"handleTouchMove",value:function(){this.isMove=!0}},{key:"handleTouchEnd",value:function(t,e,i){this.isMove?this.isMove=!1:(this.props.AddMusicId(t),this.props.history.push("/pic/"+t),this.props.changeMusicPlay(),this.props.changeMusicName(e),this.AddNextId())}},{key:"AddNextId",value:function(){for(var t=JSON.parse(N("songsList")),e=0;e<t.length;e++)t[e].id===this.props.MusicId&&this.props.AddNextMusicId(t[e+1])}}]),e}(n.Component);var L=Object(m.b)(function(t){return{MusicId:t.isMusicId,ClassActive:t.isClassActive}},function(t){return{iconBack:function(){t({type:"IS_ICON_BACK",payload:!1})},AddMusicId:function(e){t({type:"IS_MUSIC_CHANGE",payload:e})},AddNextMusicId:function(e){t({type:"IS_MUSIC_NextId",payload:e})},changeMusicPlay:function(){t({type:"IS_MUSIC_PLAY",payload:!0})},changeMusicName:function(e){t({type:"IS_CHANGE_NAME",payload:e})},setPathName:function(){t({type:"IS_CHANGE_PATHNAME",payload:"list"})},setLyricRunning:function(){t({type:"IS_CHANGE_LyricRunning",payload:"list"})}}})(C),S=(i(69),function(t){function e(){var t;return Object(o.a)(this,e),(t=Object(u.a)(this,Object(l.a)(e).call(this))).PlayBtnChange=t.PlayBtnChange.bind(Object(b.a)(Object(b.a)(t))),t}return Object(d.a)(e,t),Object(r.a)(e,[{key:"render",value:function(){return a.a.createElement("div",{id:"musicAudio"},a.a.createElement("div",{ref:"PlayBtn",className:"audioPlay",onTouchStart:this.PlayBtnChange}),a.a.createElement("div",{className:"audioProgress",ref:"audioProgess"},a.a.createElement("div",{className:"audioBar",ref:"audioBar"}),a.a.createElement("div",{className:"audioNow",ref:"audioNow"})),a.a.createElement("audio",{ref:"audioElement",id:"audioE",src:"https://api.hibai.cn/music/Music/Music?id="+this.props.isMusicId+"&type=url"}))}},{key:"componentDidMount",value:function(){this.musicBarDrag()}},{key:"componentDidUpdate",value:function(){this.musicBarDrag(),this.props.isMusicPlay?this.playMusic():this.pauseMusic()}},{key:"playMusic",value:function(){this.refs.PlayBtn.style.backgroundImage="url(/images/list_audioPause.png)",this.refs.audioElement.play(),this.props.isMusicPlayCtrl(),this.listenRun.bind(this),setInterval(this.listenRun.bind(this),1e3)}},{key:"pauseMusic",value:function(){this.refs.PlayBtn.style.backgroundImage="url(/images/list_audioPlay.png)",this.refs.audioElement.pause(),this.props.isMusicPausedCtrl(),clearInterval(this.listenRun.bind(this))}},{key:"PlayBtnChange",value:function(){this.props.isMusicId,this.refs.audioElement.paused?this.playMusic():this.pauseMusic()}},{key:"listenRun",value:function(){var t=this.refs.audioNow,e=this.refs.audioBar,i=this.refs.audioElement,n=i.currentTime/i.duration;e.style.left=n*(e.parentNode.offsetWidth-7)+"px",t.style.width=100*n+"%",1===n&&(this.props.isMusicPausedCtrl(),this.pauseMusic(),t.style.width="0%",e.style.left="-7px",this.props.AddMusicId!==this.props.isListNextId.id&&(this.props.AddMusicId(this.props.isListNextId.id),this.props.changeMusicName(this.props.isListNextId.title),this.props.isMusicPlayCtrl(),this.playMusic(),this.AddNextId()))}},{key:"AddNextId",value:function(){for(var t=JSON.parse(N("songsList")),e=0;e<t.length;e++)t[e].id===this.props.isMusicId&&this.props.AddNextMusicId(t[e+1])}},{key:"musicBarDrag",value:function(){var t=0,e=this.refs.audioNow,i=this.refs.audioBar,n=this.refs.audioElement;i.ontouchstart=function(i){var a=this,s=i.changedTouches[0];return t=s.pageX-this.offsetLeft,document.ontouchmove=function(i){var s=i.changedTouches[0].pageX-t;try{s<-7?s=-7:s>a.parentNode.offsetWidth-7&&(s=a.parentNode.offsetWidth-7)}catch(o){return}a.style.left=s+"px";var c=(s+7)/a.parentNode.offsetWidth;e.style.width=100*c+"%";try{n.currentTime=c*n.duration}catch(o){}},document.ontouchend=function(){document.ontouchmove=document.ontouchend=null},!1}}}]),e}(n.Component));var O=Object(m.b)(function(t){return{isMusicId:t.isMusicId,isMusicPlay:t.isMusicPlay,isLyricRunning:t.isLyricRunning,isListNextId:t.isListNextId}},function(t){return{isMusicPlayCtrl:function(){t({type:"IS_MUSIC_PLAY",payload:!0})},isMusicPausedCtrl:function(){t({type:"IS_MUSIC_PLAY",payload:!1})},AddMusicId:function(e){t({type:"IS_MUSIC_CHANGE",payload:e})},AddNextMusicId:function(e){t({type:"IS_MUSIC_NextId",payload:e})},changeMusicName:function(e){t({type:"IS_CHANGE_NAME",payload:e})}}})(S),_=(i(71),function(t){function e(){var t;return Object(o.a)(this,e),(t=Object(u.a)(this,Object(l.a)(e).call(this))).state={fid:""},t.ChangeLyric=t.ChangeLyric.bind(Object(b.a)(Object(b.a)(t))),t}return Object(d.a)(e,t),Object(r.a)(e,[{key:"render",value:function(){return a.a.createElement("div",{id:"pic"},a.a.createElement("div",{className:"picRoll",ref:"picEle",onTouchStart:this.ChangeLyric},a.a.createElement("img",{alt:"",src:"https://api.hibai.cn/music/Music/Music?id="+this.props.PicId+"&type=pic"})))}},{key:"componentDidMount",value:function(){this.props.setLyricRunning(),this.setState({fid:this.props.PicId}),this.props.iconBack(),this.props.PicPlay?this.picRollAction():this.picRollStop()}},{key:"componentDidUpdate",value:function(){this.props.setPathName(),this.props.PicPlay?this.picRollAction():this.picRollStop()}},{key:"picRollAction",value:function(){this.refs.picEle.style.animationPlayState="running"}},{key:"picRollStop",value:function(){this.refs.picEle.style.animationPlayState="paused"}},{key:"ChangeLyric",value:function(){this.props.history.push("/lyric/"+this.state.fid)}}]),e}(n.Component));var A=Object(m.b)(function(t){return{PathName:t.isPathName,PicId:t.isMusicId,PicPlay:t.isMusicPlay}},function(t){return{iconBack:function(){t({type:"IS_ICON_BACK",payload:!0})},setPathName:function(){t({type:"IS_CHANGE_PATHNAME",payload:"pic"})},setLyricRunning:function(){t({type:"IS_CHANGE_LyricRunning",payload:"pic"})}}})(_),j=(i(73),function(t){function e(){return Object(o.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(d.a)(e,t),Object(r.a)(e,[{key:"render",value:function(){return a.a.createElement("div",null)}},{key:"componentDidMount",value:function(){this.backStart()}},{key:"backStart",value:function(){var t,e,i,n,a,s,c,o=Math.PI,r=Math.cos,u=Math.sin,l=Math.random,d=2*o,h=function(t){return t*l()},p=function(t,e){return h(e-t)+t},y=function(t,e){return t/e},f=1e3;function m(){var e=window,n=e.innerWidth,a=e.innerHeight;t.a.width=t.b.width=n,t.a.height=t.b.height=a,i[0]=.5*n,i[1]=.5*a}function v(t){var e,o,l,y,f,m,v,g,b,I,M,E;e=t+1,o=h(100),l=h(d),y=r(l),f=u(l),m=i[0]+y*o,v=i[1]+f*o,b=(g=p(.1,1))*y,I=g*f,M=h(360),E=p(20,100),n[t]=m,n[e]=v,a[t]=b,a[e]=I,c[.5*t|0]=M,s[t]=0,s[e]=E}function g(i){var o,r,u,l,d,h,p,f,m,g,b,I;o=i+1,r=n[i],u=n[o],l=r+(h=a[i]),d=u+(p=a[o]),h*=1.15,p*=1.15,f=c[.5*i|0],m=s[i],b=s[o],g=y(m,b),I="hsla(".concat(f,",50%,80%,1)"),m++,e.a.save(),e.a.lineWidth=g,e.a.lineCap="round",e.a.strokeStyle=I,e.a.beginPath(),e.a.moveTo(r,u),e.a.lineTo(l,d),e.a.stroke(),e.a.closePath(),e.a.restore(),n[i]=l,n[o]=d,a[i]=h,a[o]=p,s[i]=m,function(e,i){return e>t.a.width||e<0||i>t.a.height||i<0}(r,u)&&v(i)}function b(){var i;for(e.a.clearRect(0,0,t.a.width,t.a.height),e.b.clearRect(0,0,t.b.width,t.b.height),e.b.fillStyle="rgba(0,0,0,0.5)",e.b.fillRect(0,0,t.b.width,t.b.height),i=0;i<2*f;i+=2)g(i);e.b.save(),e.b.filter="blur(10px)",e.b.drawImage(t.a,0,0),e.b.restore(),e.b.save(),e.b.globalCompositeOperation="lighter",e.b.drawImage(t.a,0,0),e.b.restore(),window.requestAnimationFrame(b)}window.addEventListener("load",function(){(t={a:document.createElement("canvas"),b:document.createElement("canvas")}).b.style="\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\twidth: 100%;\n\t\theight: 100%;\n\t",document.body.appendChild(t.b),e={a:t.a.getContext("2d"),b:t.b.getContext("2d")},i=[],m(),function(){var t;for(n=new Float32Array(2*f),a=new Float32Array(2*f),c=new Float32Array(f),s=new Float32Array(2*f),t=0;t<2*f;t+=2)v(t)}(),b()}),window.addEventListener("resize",m)}}]),e}(n.Component)),P=(i(75),function(t){function e(){var t;return Object(o.a)(this,e),(t=Object(u.a)(this,Object(l.a)(e).call(this))).state={lyricList:[],lyricHeight:21,lyricActive:-1},t.forTimeClear=t.forTimeClear.bind(Object(b.a)(Object(b.a)(t))),t.ChangeLyric=t.ChangeLyric.bind(Object(b.a)(Object(b.a)(t))),t}return Object(d.a)(e,t),Object(r.a)(e,[{key:"render",value:function(){var t=this;return a.a.createElement("div",{id:"musicLyric"},a.a.createElement("ul",{ref:"lyricUL",onTouchStart:this.ChangeLyric},this.state.lyricList.map(function(e,i){return a.a.createElement("li",{className:t.state.lyricActive===i?"active":"",key:i},e.lyric)})))}},{key:"componentDidMount",value:function(){var t=this;this.props.iconBack(),this.props.setLyricRunning();var e=this.props.match.params.fid;M.a.get("/music/Music/Music?id="+e+"&type=lrc").then(function(e){t.setState({lyricList:t.formatLyric(e.data)})})}},{key:"componentDidUpdate",value:function(){"lyric"===this.props.isLyricRunning&&(this.props.isMusicPlay?this.playLyric():this.pausedLyric())}},{key:"componentWillUnmount",value:function(){this.pausedLyric()}},{key:"formatLyric",value:function(t){var e=this,i=[];return t.replace(/\[([^\]]+)\]([^[]+)/g,function(t,n,a){i.push({time:e.forTimeClear(n),lyric:a})}),i}},{key:"forTimeClear",value:function(t){var e=t.split(":");return(60*parseFloat(e[0])+parseFloat(e[1])).toFixed(2)}},{key:"playLyric",value:function(){window.setInterval(this.lyricRunning.bind(this),2e3)}},{key:"pausedLyric",value:function(){clearInterval(this.timer)}},{key:"ChangePic",value:function(){this.props.history.push("/lyric/"+this.state.fid)}},{key:"lyricRunning",value:function(){for(var t=this,e=this.refs.lyricUL,i=this.state.lyricList,n=document.getElementById("audioE"),a=0;a<i.length;a++){try{var s=i[a].time||50}catch(o){}try{if(n.currentTime>s&&n.currentTime<i[a+1].time){this.setState({lyricActive:a}),a>5&&(e.style.top=-(a-5)*(this.props.isLyricHieght+30)+"px",i.length-2===a&&(this.pausedLyric(),this.setState({lyricActive:i.length-1})));var c=this.props.match.params.fid;M.a.get("/music/Music/Music?id="+c+"&type=lrc").then(function(e){t.setState({lyricList:t.formatLyric(e.data)})})}}catch(r){}}}},{key:"ChangeLyric",value:function(){this.props.history.push("/pic/"+this.props.match.params.fid)}}]),e}(n.Component));var k=Object(m.b)(function(t){return{fid:t.isMusicId,isMusicPlay:t.isMusicPlay,isLyricRunning:t.isLyricRunning,isLyricHieght:t.isLyricHieght}},function(t){return{iconBack:function(){t({type:"IS_ICON_BACK",payload:"true"})},AddMusicId:function(e){t({type:"IS_MUSIC_CHANGE",payload:e})},setLyricRunning:function(){t({type:"IS_CHANGE_LyricRunning",payload:"lyric"})},setLyricHieght:function(e){t({type:"IS_CHANGE_LyricHieght",payload:e})}}})(P),w=function(t){function e(){return Object(o.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(d.a)(e,t),Object(r.a)(e,[{key:"render",value:function(){return a.a.createElement(h.a,null,a.a.createElement("div",{id:"main"},a.a.createElement(g,null),a.a.createElement(p.a,null,a.a.createElement(y.a,{path:"/list",component:L}),a.a.createElement(y.a,{path:"/pic/:fid",component:A}),a.a.createElement(y.a,{path:"/lyric/:fid",component:k}),a.a.createElement(f.a,{from:"/*",to:"/list"})),a.a.createElement(O,null),a.a.createElement(j,null)))}}]),e}(n.Component),T=i(14);var H=Object(T.b)({isPathName:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"pic",e=arguments.length>1?arguments[1]:void 0;return"IS_CHANGE_PATHNAME"===e.type?e.payload:t},islistIcon:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1?arguments[1]:void 0;return"IS_ICON_BACK"===e.type?e.payload:t},isMusicId:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0;return"IS_MUSIC_CHANGE"===e.type?e.payload:t},isMusicPlay:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1?arguments[1]:void 0;return"IS_MUSIC_PLAY"===e.type?e.payload:t},isMusicName:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0;return"IS_CHANGE_NAME"===e.type?e.payload:t},isClassActive:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"active",e=arguments.length>1?arguments[1]:void 0;return"IS_CHANGE_CLASS"===e.type?e.payload:t},isLyricRunning:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"pic",e=arguments.length>1?arguments[1]:void 0;return"IS_CHANGE_LyricRunning"===e.type?e.payload:t},isLyricHieght:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0;return"IS_CHANGE_LyricHieght"===e.type?e.payload:t},isListNextId:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;return"IS_MUSIC_NextId"===e.type?e.payload:t}}),R=Object(T.c)(H,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());c.a.render(a.a.createElement(m.a,{store:R},a.a.createElement(w,null)),document.getElementById("root"))}},[[30,2,1]]]);
//# sourceMappingURL=main.7ebfe59a.chunk.js.map